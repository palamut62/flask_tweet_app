{% extends "base.html" %}

{% block title %}AI Tweet Bot - GÃ¼venlik KontrolÃ¼{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/twitter-style.css') }}">
{% endblock %}

{% block content %}
<!-- Security Header - Twitter TarzÄ± -->
<div class="security-header">
    <h1 class="security-title">
        <i class="fas fa-shield-alt"></i>
        ğŸ”’ GÃ¼venlik KontrolÃ¼
    </h1>
</div>

<div class="security-content">
    <p style="color: var(--twitter-text-secondary); margin-bottom: 20px; font-size: 14px;">
        UygulamanÄ±zÄ±n gÃ¼venlik yapÄ±landÄ±rmasÄ±nÄ± kontrol edin
    </p>

    {% if security %}
        <!-- Genel Durum -->
        <div class="security-status-card">
            <div class="security-status-header">
                <div class="security-status-icon {{ 'status-secure' if security.secure else 'status-warning' }}">
                    <i class="fas fa-{{ 'shield-alt' if security.secure else 'exclamation-triangle' }}"></i>
                </div>
                <div class="security-status-info">
                    <h2 class="security-status-title {{ 'status-secure' if security.secure else 'status-warning' }}">
                        {% if security.secure %}
                            âœ… GÃ¼venlik YapÄ±landÄ±rmasÄ± Uygun
                        {% else %}
                            âš ï¸ GÃ¼venlik SorunlarÄ± Tespit Edildi
                        {% endif %}
                    </h2>
                    <p class="security-status-description">
                        {% if security.secure %}
                            TÃ¼m gÃ¼venlik kontrolleri baÅŸarÄ±lÄ±
                        {% else %}
                            {{ security.issues|length }} gÃ¼venlik sorunu bulundu
                        {% endif %}
                    </p>
                    <!-- GÃ¼venlik Skoru -->
                    <div class="security-score">
                        <div class="security-score-bar">
                            <div class="security-score-fill {{ 'score-high' if security.security_score >= 80 else 'score-medium' if security.security_score >= 60 else 'score-low' }}" 
                                 style="width: {{ security.security_score if security.security_score else 0 }}%"></div>
                        </div>
                        <span class="security-score-text {{ 'score-high' if security.security_score >= 80 else 'score-medium' if security.security_score >= 60 else 'score-low' }}">
                            {{ security.security_score }}% ({{ security.security_level }})
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- GÃ¼venlik Ä°statistikleri -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number stat-success">{{ security.passed_checks }}</div>
                <div class="stat-label">BaÅŸarÄ±lÄ± Kontrol</div>
            </div>
            <div class="stat-card">
                <div class="stat-number stat-danger">{{ security.issues|length }}</div>
                <div class="stat-label">GÃ¼venlik Sorunu</div>
            </div>
            <div class="stat-card">
                <div class="stat-number stat-info">{{ security.total_checks }}</div>
                <div class="stat-label">Toplam Kontrol</div>
            </div>
            <div class="stat-card">
                <div class="stat-number stat-warning">{{ security.auth_method }}</div>
                <div class="stat-label">GiriÅŸ YÃ¶ntemi</div>
            </div>
        </div>

        <!-- GÃ¼venlik SorunlarÄ± -->
        {% if security.issues %}
            <div class="security-issues-card">
                <div class="security-issues-header">
                    <h3 class="security-issues-title">
                        <i class="fas fa-exclamation-triangle"></i>
                        GÃ¼venlik SorunlarÄ± ({{ security.issues|length }})
                    </h3>
                </div>
                <div class="security-issues-body">
                    <ul class="security-issues-list">
                        {% for issue in security.issues %}
                            <li class="security-issue-item">
                                <i class="fas fa-times-circle"></i>
                                <span>{{ issue }}</span>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        {% endif %}

        <!-- Sistem Bilgileri -->
        <div class="system-info-grid">
            <!-- Sistem Modu -->
            <div class="system-info-card">
                <div class="system-info-header">
                    <h3 class="system-info-title">
                        <i class="fas fa-cog"></i>
                        Sistem Modu
                    </h3>
                </div>
                <div class="system-info-body">
                    <div class="system-info-item">
                        <span class="system-info-label">Debug Modu:</span>
                        <span class="system-info-value {{ 'status-warning' if security.debug_mode else 'status-success' }}">
                            {{ 'AÃ§Ä±k' if security.debug_mode else 'KapalÄ±' }}
                        </span>
                    </div>
                    <div class="system-info-item">
                        <span class="system-info-label">Flask OrtamÄ±:</span>
                        <span class="system-info-value {{ 'status-success' if security.flask_env == 'production' else 'status-warning' }}">
                            {{ security.flask_env|title }}
                        </span>
                    </div>
                </div>
            </div>

            <!-- E-posta OTP Sistemi -->
            <div class="system-info-card">
                <div class="system-info-header">
                    <h3 class="system-info-title">
                        <i class="fas fa-envelope"></i>
                        E-posta OTP
                    </h3>
                </div>
                <div class="system-info-body">
                    <div class="system-info-item">
                        <span class="system-info-label">Admin E-posta:</span>
                        <span class="system-info-value {{ 'status-success' if security.admin_email else 'status-danger' }}">
                            {{ 'YapÄ±landÄ±rÄ±lmÄ±ÅŸ' if security.admin_email else 'Eksik' }}
                        </span>
                    </div>
                    <div class="system-info-item">
                        <span class="system-info-label">SMTP YapÄ±landÄ±rmasÄ±:</span>
                        <span class="system-info-value {{ 'status-success' if security.email_configured else 'status-danger' }}">
                            {{ 'Aktif' if security.email_configured else 'Eksik' }}
                        </span>
                    </div>
                    {% if security.admin_email %}
                        <div class="system-info-email">
                            Admin: {{ security.admin_email[:3] }}***@{{ security.admin_email.split('@')[1] if '@' in security.admin_email else '***' }}
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- GÃ¼venlik Ã–zellikleri -->
            <div class="system-info-card">
                <div class="system-info-header">
                    <h3 class="system-info-title">
                        <i class="fas fa-shield-alt"></i>
                        GÃ¼venlik Ã–zellikleri
                    </h3>
                </div>
                <div class="system-info-body">
                    <div class="system-info-item">
                        <span class="system-info-label">GÃ¼venli Logging:</span>
                        <span class="system-info-value status-success">Aktif</span>
                    </div>
                    <div class="system-info-item">
                        <span class="system-info-label">API Maskeleme:</span>
                        <span class="system-info-value status-success">Aktif</span>
                    </div>
                    <div class="system-info-item">
                        <span class="system-info-label">OTP DoÄŸrulama:</span>
                        <span class="system-info-value status-success">Aktif</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- GÃ¼venlik Ã–nerileri -->
        <div class="security-recommendations-card">
            <div class="security-recommendations-header">
                <h3 class="security-recommendations-title">
                    <i class="fas fa-lightbulb"></i>
                    GÃ¼venlik Ã–nerileri
                </h3>
            </div>
            <div class="security-recommendations-body">
                <div class="recommendations-grid">
                    <ul class="recommendations-list">
                        <li class="recommendation-item">
                            <i class="fas fa-check-circle"></i>
                            <span>Environment variable'larÄ±nÄ±zÄ± <code>.env</code> dosyasÄ±nda saklayÄ±n</span>
                        </li>
                        <li class="recommendation-item">
                            <i class="fas fa-check-circle"></i>
                            <span>Production'da <code>DEBUG=False</code> ayarlayÄ±n</span>
                        </li>
                        <li class="recommendation-item">
                            <i class="fas fa-check-circle"></i>
                            <span>Gmail iÃ§in <strong>App Password</strong> kullanÄ±n (normal ÅŸifre deÄŸil)</span>
                        </li>
                        <li class="recommendation-item">
                            <i class="fas fa-check-circle"></i>
                            <span>Admin e-posta adresini gÃ¼venli tutun</span>
                        </li>
                    </ul>
                    <ul class="recommendations-list">
                        <li class="recommendation-item">
                            <i class="fas fa-check-circle"></i>
                            <span>API anahtarlarÄ±nÄ±zÄ± dÃ¼zenli olarak yenileyin</span>
                        </li>
                        <li class="recommendation-item">
                            <i class="fas fa-check-circle"></i>
                            <span><code>.env</code> dosyasÄ±nÄ± asla Git'e commit etmeyin</span>
                        </li>
                        <li class="recommendation-item">
                            <i class="fas fa-check-circle"></i>
                            <span>OTP kodlarÄ±nÄ± kimseyle paylaÅŸmayÄ±n</span>
                        </li>
                        <li class="recommendation-item">
                            <i class="fas fa-check-circle"></i>
                            <span>GÃ¼Ã§lÃ¼ ve benzersiz <code>SECRET_KEY</code> kullanÄ±n</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- E-posta OTP Kurulum Rehberi -->
        {% if not security.email_configured %}
            <div class="security-setup-card">
                <div class="security-setup-header">
                    <h3 class="security-setup-title">
                        <i class="fas fa-wrench"></i>
                        E-posta OTP Kurulum Rehberi
                    </h3>
                </div>
                <div class="security-setup-body">
                    <div class="setup-step">
                        <h4 class="setup-step-title">1. Gmail App Password OluÅŸturun:</h4>
                        <ol class="setup-step-list">
                            <li>Google hesabÄ±nÄ±zda 2FA'yÄ± aktif edin</li>
                            <li><a href="https://myaccount.google.com/apppasswords" target="_blank" class="setup-link">Google App Passwords</a> sayfasÄ±na gidin</li>
                            <li>"AI Tweet Bot" iÃ§in yeni app password oluÅŸturun</li>
                            <li>OluÅŸturulan 16 haneli ÅŸifreyi kopyalayÄ±n</li>
                        </ol>
                    </div>
                    <div class="setup-step">
                        <h4 class="setup-step-title">2. Environment Variables'larÄ± AyarlayÄ±n:</h4>
                        <pre class="setup-code"><code>ADMIN_EMAIL=your-admin@gmail.com
EMAIL_ADDRESS=your-sender@gmail.com  
EMAIL_PASSWORD=your-16-digit-app-password
SECRET_KEY=your-very-long-secret-key-here</code></pre>
                    </div>
                </div>
            </div>
        {% endif %}

    {% else %}
        <div class="security-error-card">
            <div class="security-error-content">
                <i class="fas fa-exclamation-triangle"></i>
                <h2 class="security-error-title">GÃ¼venlik KontrolÃ¼ YapÄ±lamadÄ±</h2>
                <p class="security-error-description">Sistem yapÄ±landÄ±rmasÄ± kontrol edilemedi.</p>
            </div>
        </div>
    {% endif %}

    <!-- Geri DÃ¶n -->
    <div class="security-back-button">
        <a href="{{ url_for('settings') }}" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i>
            Ayarlara Geri DÃ¶n
        </a>
    </div>
</div>
{% endblock %} 